% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[top=0.5cm]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={happiness\_analysis},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{happiness\_analysis}
\author{}
\date{\vspace{-2.5em}2024-12-01}

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\#\#\# Partial residual plots \#\#\#\#}

\NormalTok{ls.part.res.plot }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x,y,j,}\AttributeTok{intercept=}\ConstantTok{TRUE}\NormalTok{,}\AttributeTok{x.name=}\ConstantTok{NULL}\NormalTok{,}\AttributeTok{y.name=}\StringTok{"Y"}\NormalTok{,}\AttributeTok{main=}\ConstantTok{NULL}\NormalTok{)}
  
  \CommentTok{\# Produces a partial{-}residual plot for variable j in x. }
  \CommentTok{\# x {-} X matrix for current model (no column of 1\textquotesingle{}s should be included for}
  \CommentTok{\#     for an intercept term);}
  \CommentTok{\# y {-} Y vector;}
  \CommentTok{\# j {-} a column number of x;}
  \CommentTok{\# intercept {-} set to FALSE for a no{-}intercept model;}
  \CommentTok{\# x.name {-} x{-}axis label {-} if not supplied, then the name of column}
  \CommentTok{\#          j in x will be used;}
  \CommentTok{\# y.name {-} y{-}axis label;}
  \CommentTok{\# main {-} main title for plot, if not supplied then the title is of the form}
\CommentTok{\#        "Partial{-}residual plot for x".}

\NormalTok{\{ }\CommentTok{\# Get residuals. }
\NormalTok{  reg }\OtherTok{\textless{}{-}} \FunctionTok{lsfit}\NormalTok{(x,y,}\AttributeTok{intercept=}\NormalTok{intercept)}
\NormalTok{  res }\OtherTok{\textless{}{-}}\NormalTok{ reg}\SpecialCharTok{$}\NormalTok{residuals}
  
  
  \CommentTok{\# add component from x\_j}
  \CommentTok{\# if there is an intercept, we want coeeficient j+1}
  
\NormalTok{  jj }\OtherTok{\textless{}{-}}\NormalTok{ j}
  \ControlFlowTok{if}\NormalTok{(intercept }\SpecialCharTok{==} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{    jj }\OtherTok{\textless{}{-}}\NormalTok{ j}\SpecialCharTok{+}\DecValTok{1}
\NormalTok{  res }\OtherTok{\textless{}{-}}\NormalTok{ res}\SpecialCharTok{+}\NormalTok{reg}\SpecialCharTok{$}\NormalTok{coef[jj]}\SpecialCharTok{*}\NormalTok{x[,j]}
  
  \CommentTok{\# set up labels. }
  
  \ControlFlowTok{if}\NormalTok{(}\FunctionTok{mode}\NormalTok{(x.name) }\SpecialCharTok{==} \StringTok{"NULL"}\NormalTok{)}
\NormalTok{    x.name }\OtherTok{\textless{}{-}} \FunctionTok{dimnames}\NormalTok{(x)[[}\DecValTok{2}\NormalTok{]][j]}
  \ControlFlowTok{if}\NormalTok{(}\FunctionTok{mode}\NormalTok{(main) }\SpecialCharTok{==} \StringTok{"NULL"}\NormalTok{)}
\NormalTok{    main }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(}\StringTok{"Partial{-}residual plot for"}\NormalTok{, x.name)}
  
  
  \FunctionTok{plot}\NormalTok{(x[,j], res, }\AttributeTok{main=}\NormalTok{main, }\AttributeTok{xlab=}\NormalTok{x.name,}
       \AttributeTok{ylab=}\FunctionTok{paste}\NormalTok{(}\StringTok{"Partial residuals for"}\NormalTok{,y.name))}
  \FunctionTok{lines}\NormalTok{(}\FunctionTok{lowess}\NormalTok{(x[,j],res))}
\NormalTok{\}}

\DocumentationTok{\#\#\#\#\# Added{-}variable plot \#\#\#\#\#}

\NormalTok{ls.added.var.plot }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x,y,added.var,}\AttributeTok{intercept=}\ConstantTok{TRUE}\NormalTok{,}
                              \AttributeTok{x.name=}\StringTok{"X"}\NormalTok{,}\AttributeTok{y.name=}\StringTok{"Y"}\NormalTok{,}\AttributeTok{main=}\StringTok{""}\NormalTok{)}
  \CommentTok{\# Produces an added{-}variable plot.}
  \CommentTok{\# x {-} X matrix for current model (no column of 1\textquotesingle{}s should be included for}
  \CommentTok{\#     for an intercept term);}
  \CommentTok{\# y {-} Y vector;}
  \CommentTok{\# added.var {-} if a scalar, a column number of x;}
  \CommentTok{\#              if a vector of length \textgreater{} 1, values for a "new" x variable.}
  \CommentTok{\# intercept {-} set to FALSE for a no{-}intercept model;}
  \CommentTok{\# x.name {-} x{-}axis label {-} if added.var is a scalar, the default "x" is }
  \CommentTok{\#           replaced by the name of column added.var;}
  \CommentTok{\# y.name {-} y{-}axis label;}
  \CommentTok{\# main {-} main title for plot, if not supplied then the title is of the form}
\CommentTok{\#        "Added{-}variable plot for x".}
\NormalTok{\{}
  \ControlFlowTok{if}\NormalTok{(}\FunctionTok{length}\NormalTok{(added.var)}\SpecialCharTok{==}\DecValTok{1}\NormalTok{)}
\NormalTok{  \{ }
    \CommentTok{\# added.var is a column number for a variable in x.}
    \ControlFlowTok{if}\NormalTok{(x.name }\SpecialCharTok{==}\StringTok{"X"}\NormalTok{)}
\NormalTok{      x.name }\OtherTok{\textless{}{-}} \FunctionTok{dimnames}\NormalTok{(x)[[}\DecValTok{2}\NormalTok{]][added.var]}
\NormalTok{    xtilde }\OtherTok{\textless{}{-}}\NormalTok{ x[,}\SpecialCharTok{{-}}\NormalTok{added.var]}
\NormalTok{    s.res }\OtherTok{\textless{}{-}} \FunctionTok{lsfit}\NormalTok{(xtilde,y,}\AttributeTok{intercept=}\NormalTok{intercept)}\SpecialCharTok{$}\NormalTok{residuals}
\NormalTok{    t.res }\OtherTok{\textless{}{-}} \FunctionTok{lsfit}\NormalTok{(xtilde,x[,added.var],}\AttributeTok{intercept=}\NormalTok{intercept)}\SpecialCharTok{$}\NormalTok{residuals}
\NormalTok{  \}}
  \ControlFlowTok{else}
\NormalTok{  \{}
    \CommentTok{\# added.var is a "new" x variable not in x.}
\NormalTok{    s.res }\OtherTok{\textless{}{-}} \FunctionTok{lsfit}\NormalTok{(x,y,}\AttributeTok{intercept=}\NormalTok{intercept)}\SpecialCharTok{$}\NormalTok{residuals}
\NormalTok{    t.res }\OtherTok{\textless{}{-}} \FunctionTok{lsfit}\NormalTok{(x,added.var,}\AttributeTok{intercept=}\NormalTok{intercept)}\SpecialCharTok{$}\NormalTok{residuals}
\NormalTok{  \}}
  
  \ControlFlowTok{if}\NormalTok{(main }\SpecialCharTok{==}\StringTok{""}\NormalTok{)}
\NormalTok{    main }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(}\StringTok{"Added{-}variable plot for"}\NormalTok{, x.name)}
  
  \FunctionTok{plot}\NormalTok{(t.res,s.res,}\AttributeTok{main=}\NormalTok{main,}\AttributeTok{xlab=}\FunctionTok{paste}\NormalTok{(}\StringTok{"Corrected"}\NormalTok{,x.name),}
       \AttributeTok{ylab=}\FunctionTok{paste}\NormalTok{(}\StringTok{"Corrected"}\NormalTok{,y.name))}
  \FunctionTok{lines}\NormalTok{(}\FunctionTok{lowess}\NormalTok{(t.res,s.res))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

We will be performing residual analysis on 2019\_happiness\_cleaned.csv,
the Happiness dataset for 2019.

Installing packages

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Install and import package to deal with the categorical variable, region.}
\ControlFlowTok{if}\NormalTok{ (}\SpecialCharTok{!}\FunctionTok{require}\NormalTok{(fastDummies)) }\FunctionTok{install.packages}\NormalTok{(}\StringTok{\textquotesingle{}fastDummies\textquotesingle{}}\NormalTok{, }\AttributeTok{dependencies =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: fastDummies
\end{verbatim}

\begin{verbatim}
## Warning: package 'fastDummies' was built under R version 4.4.2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(fastDummies)}
\end{Highlighting}
\end{Shaded}

Now we read in the CSV file.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Import the csv file}
\NormalTok{HAPPY }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"2019\_happiness\_cleaned.csv"}\NormalTok{)}
\CommentTok{\# Remove rank, as we will be using score as the response variable}
\NormalTok{HAPPY }\OtherTok{\textless{}{-}} \FunctionTok{subset}\NormalTok{(HAPPY, }\AttributeTok{select =} \SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(rank))}
\FunctionTok{head}\NormalTok{(HAPPY)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##           region score   gdp support life_expectancy freedom generosity
## 1 Western Europe 7.769 1.340   1.587           0.986   0.596      0.153
## 2 Western Europe 7.600 1.383   1.573           0.996   0.592      0.252
## 3 Western Europe 7.554 1.488   1.582           1.028   0.603      0.271
## 4 Western Europe 7.494 1.380   1.624           1.026   0.591      0.354
## 5 Western Europe 7.488 1.396   1.522           0.999   0.557      0.322
## 6 Western Europe 7.480 1.452   1.526           1.052   0.572      0.263
##   corruption
## 1      0.393
## 2      0.410
## 3      0.341
## 4      0.118
## 5      0.298
## 6      0.343
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Create dummy variables}
\NormalTok{HAPPY2 }\OtherTok{\textless{}{-}} \FunctionTok{dummy\_cols}\NormalTok{(HAPPY, }\AttributeTok{select\_columns =} \StringTok{"region"}\NormalTok{)}
\CommentTok{\# Drop the \textasciigrave{}region\textasciigrave{}, because we have converted it into dummy variables}
\CommentTok{\# Drop the\textasciigrave{}Australia and New Zealand\textasciigrave{} region, because we need to ensure t(X) \%*\% X will be non{-}singular.}
\NormalTok{HAPPY2 }\OtherTok{\textless{}{-}} \FunctionTok{subset}\NormalTok{(HAPPY2, }\AttributeTok{select =} \SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(region, }\StringTok{\textasciigrave{}}\AttributeTok{region\_Australia and New Zealand}\StringTok{\textasciigrave{}}\NormalTok{))}
\FunctionTok{head}\NormalTok{(HAPPY2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   score   gdp support life_expectancy freedom generosity corruption
## 1 7.769 1.340   1.587           0.986   0.596      0.153      0.393
## 2 7.600 1.383   1.573           0.996   0.592      0.252      0.410
## 3 7.554 1.488   1.582           1.028   0.603      0.271      0.341
## 4 7.494 1.380   1.624           1.026   0.591      0.354      0.118
## 5 7.488 1.396   1.522           0.999   0.557      0.322      0.298
## 6 7.480 1.452   1.526           1.052   0.572      0.263      0.343
##   region_Central and Eastern Europe region_Eastern Asia
## 1                                 0                   0
## 2                                 0                   0
## 3                                 0                   0
## 4                                 0                   0
## 5                                 0                   0
## 6                                 0                   0
##   region_Latin America and Caribbean region_Middle East and Northern Africa
## 1                                  0                                      0
## 2                                  0                                      0
## 3                                  0                                      0
## 4                                  0                                      0
## 5                                  0                                      0
## 6                                  0                                      0
##   region_North America region_Southeastern Asia region_Southern Asia
## 1                    0                        0                    0
## 2                    0                        0                    0
## 3                    0                        0                    0
## 4                    0                        0                    0
## 5                    0                        0                    0
## 6                    0                        0                    0
##   region_Sub-Saharan Africa region_Western Europe
## 1                         0                     1
## 2                         0                     1
## 3                         0                     1
## 4                         0                     1
## 5                         0                     1
## 6                         0                     1
\end{verbatim}

We will define the X matrix. This matrix will consist of these columns,
in this order: Intercept, GDP per Capita, Social support, Healthy life
expectancy, The freedom to make life choices, Generosity, Perceptions of
corruption, and all the Region variables (except the Australia and New
Zealand region).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{X }\OtherTok{\textless{}{-}} \FunctionTok{cbind}\NormalTok{(}\DecValTok{1}\NormalTok{, }\FunctionTok{as.matrix}\NormalTok{( HAPPY2[,}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\SpecialCharTok{:}\FunctionTok{ncol}\NormalTok{(HAPPY2))] ))}
\FunctionTok{head}\NormalTok{(X)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       gdp support life_expectancy freedom generosity corruption
## 1 1 1.340   1.587           0.986   0.596      0.153      0.393
## 2 1 1.383   1.573           0.996   0.592      0.252      0.410
## 3 1 1.488   1.582           1.028   0.603      0.271      0.341
## 4 1 1.380   1.624           1.026   0.591      0.354      0.118
## 5 1 1.396   1.522           0.999   0.557      0.322      0.298
## 6 1 1.452   1.526           1.052   0.572      0.263      0.343
##   region_Central and Eastern Europe region_Eastern Asia
## 1                                 0                   0
## 2                                 0                   0
## 3                                 0                   0
## 4                                 0                   0
## 5                                 0                   0
## 6                                 0                   0
##   region_Latin America and Caribbean region_Middle East and Northern Africa
## 1                                  0                                      0
## 2                                  0                                      0
## 3                                  0                                      0
## 4                                  0                                      0
## 5                                  0                                      0
## 6                                  0                                      0
##   region_North America region_Southeastern Asia region_Southern Asia
## 1                    0                        0                    0
## 2                    0                        0                    0
## 3                    0                        0                    0
## 4                    0                        0                    0
## 5                    0                        0                    0
## 6                    0                        0                    0
##   region_Sub-Saharan Africa region_Western Europe
## 1                         0                     1
## 2                         0                     1
## 3                         0                     1
## 4                         0                     1
## 5                         0                     1
## 6                         0                     1
\end{verbatim}

We will define the Y vector. This vector will contain the happiness
scores.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Y }\OtherTok{\textless{}{-}} \FunctionTok{as.matrix}\NormalTok{( HAPPY2[,}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{)] )}
\FunctionTok{head}\NormalTok{(Y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       [,1]
## [1,] 7.769
## [2,] 7.600
## [3,] 7.554
## [4,] 7.494
## [5,] 7.488
## [6,] 7.480
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{LMHappy }\OtherTok{=} \FunctionTok{lm}\NormalTok{(score}\SpecialCharTok{\textasciitilde{}}\NormalTok{., }\AttributeTok{data=}\NormalTok{HAPPY2)}
\FunctionTok{summary}\NormalTok{(LMHappy)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = score ~ ., data = HAPPY2)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.68392 -0.23628  0.01338  0.31126  1.35117 
## 
## Coefficients:
##                                          Estimate Std. Error t value Pr(>|t|)
## (Intercept)                               3.00279    0.56716   5.294 4.80e-07
## gdp                                       0.94996    0.22823   4.162 5.62e-05
## support                                   0.82305    0.23187   3.550 0.000534
## life_expectancy                           0.50483    0.40263   1.254 0.212096
## freedom                                   1.55711    0.39453   3.947 0.000128
## generosity                                0.83556    0.50924   1.641 0.103200
## corruption                                0.09014    0.58136   0.155 0.877018
## `region_Central and Eastern Europe`      -0.59467    0.39890  -1.491 0.138383
## `region_Eastern Asia`                    -0.80082    0.42272  -1.894 0.060333
## `region_Latin America and Caribbean`     -0.24174    0.40515  -0.597 0.551742
## `region_Middle East and Northern Africa` -0.72920    0.40309  -1.809 0.072701
## `region_North America`                   -0.01242    0.49671  -0.025 0.980082
## `region_Southeastern Asia`               -1.12474    0.41535  -2.708 0.007661
## `region_Southern Asia`                   -1.02342    0.44144  -2.318 0.021955
## `region_Sub-Saharan Africa`              -0.77216    0.43922  -1.758 0.081044
## `region_Western Europe`                  -0.08745    0.37190  -0.235 0.814460
##                                             
## (Intercept)                              ***
## gdp                                      ***
## support                                  ***
## life_expectancy                             
## freedom                                  ***
## generosity                                  
## corruption                                  
## `region_Central and Eastern Europe`         
## `region_Eastern Asia`                    .  
## `region_Latin America and Caribbean`        
## `region_Middle East and Northern Africa` .  
## `region_North America`                      
## `region_Southeastern Asia`               ** 
## `region_Southern Asia`                   *  
## `region_Sub-Saharan Africa`              .  
## `region_Western Europe`                     
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.4907 on 133 degrees of freedom
## Multiple R-squared:  0.8247, Adjusted R-squared:  0.805 
## F-statistic: 41.72 on 15 and 133 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{anova}\NormalTok{(LMHappy)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Analysis of Variance Table
## 
## Response: score
##                                           Df  Sum Sq Mean Sq  F value    Pr(>F)
## gdp                                        1 115.918 115.918 481.3163 < 2.2e-16
## support                                    1  13.289  13.289  55.1778 1.190e-11
## life_expectancy                            1   3.968   3.968  16.4777 8.354e-05
## freedom                                    1   6.936   6.936  28.8012 3.460e-07
## generosity                                 1   0.638   0.638   2.6476  0.106076
## corruption                                 1   0.717   0.717   2.9754  0.086861
## `region_Central and Eastern Europe`        1   0.157   0.157   0.6499  0.421574
## `region_Eastern Asia`                      1   0.975   0.975   4.0475  0.046258
## `region_Latin America and Caribbean`       1   1.698   1.698   7.0508  0.008891
## `region_Middle East and Northern Africa`   1   0.637   0.637   2.6434  0.106345
## `region_North America`                     1   0.242   0.242   1.0057  0.317767
## `region_Southeastern Asia`                 1   2.562   2.562  10.6375  0.001408
## `region_Southern Asia`                     1   1.313   1.313   5.4529  0.021032
## `region_Sub-Saharan Africa`                1   1.667   1.667   6.9198  0.009531
## `region_Western Europe`                    1   0.013   0.013   0.0553  0.814460
## Residuals                                133  32.031   0.241                   
##                                             
## gdp                                      ***
## support                                  ***
## life_expectancy                          ***
## freedom                                  ***
## generosity                                  
## corruption                               .  
## `region_Central and Eastern Europe`         
## `region_Eastern Asia`                    *  
## `region_Latin America and Caribbean`     ** 
## `region_Middle East and Northern Africa`    
## `region_North America`                      
## `region_Southeastern Asia`               ** 
## `region_Southern Asia`                   *  
## `region_Sub-Saharan Africa`              ** 
## `region_Western Europe`                     
## Residuals                                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(X[,}\DecValTok{2}\NormalTok{], Y, }\AttributeTok{xlab=}\StringTok{"GDP"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Happiness Score"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{residual_files/figure-latex/unnamed-chunk-9-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(X[,}\DecValTok{3}\NormalTok{], Y, }\AttributeTok{xlab=}\StringTok{"Support"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Happiness Score"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{residual_files/figure-latex/unnamed-chunk-9-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(X[,}\DecValTok{4}\NormalTok{], Y, }\AttributeTok{xlab=}\StringTok{"Life Expectancy"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Happiness Score"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{residual_files/figure-latex/unnamed-chunk-9-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(X[,}\DecValTok{5}\NormalTok{], Y, }\AttributeTok{xlab=}\StringTok{"Freedom"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Happiness Score"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{residual_files/figure-latex/unnamed-chunk-9-4.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(X[,}\DecValTok{6}\NormalTok{], Y, }\AttributeTok{xlab=}\StringTok{"Generosity"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Happiness Score"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{residual_files/figure-latex/unnamed-chunk-9-5.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(X[,}\DecValTok{7}\NormalTok{], Y, }\AttributeTok{xlab=}\StringTok{"Corruption"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Happiness Score"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{residual_files/figure-latex/unnamed-chunk-9-6.pdf}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Residual plot against each explanatory variable,
\item
  Partial residual plot for each explanatory variable,
\item
  Added variable plot.
\item
  Residuals vs.~fitted,
\item
  Q-Q residuals (theoretical quantities vs.~standardized residuals).
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{happy.lm }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(score}\SpecialCharTok{\textasciitilde{}}\NormalTok{.,}\AttributeTok{data=}\NormalTok{HAPPY2)}

\NormalTok{happy.res.before }\OtherTok{\textless{}{-}}\NormalTok{ happy.lm}\SpecialCharTok{$}\NormalTok{residuals}

\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{))}

\FunctionTok{plot}\NormalTok{(X[,}\DecValTok{2}\NormalTok{], happy.res.before, }\AttributeTok{xlab=}\StringTok{"GDP"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"residuals"}\NormalTok{, }\AttributeTok{main=}\StringTok{"GDP Residual Plot"}\NormalTok{)}
\FunctionTok{ls.part.res.plot}\NormalTok{(X[,}\DecValTok{2}\SpecialCharTok{:}\FunctionTok{ncol}\NormalTok{(X)],Y,}\DecValTok{1}\NormalTok{)}
\FunctionTok{ls.added.var.plot}\NormalTok{(X[,}\DecValTok{2}\SpecialCharTok{:}\FunctionTok{ncol}\NormalTok{(X)],Y,}\DecValTok{1}\NormalTok{)}

\FunctionTok{plot}\NormalTok{(X[,}\DecValTok{3}\NormalTok{], happy.res.before, }\AttributeTok{xlab=}\StringTok{"Support"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"residuals"}\NormalTok{, }\AttributeTok{main=}\StringTok{"Support Residual Plot"}\NormalTok{)}
\FunctionTok{ls.part.res.plot}\NormalTok{(X[,}\DecValTok{2}\SpecialCharTok{:}\FunctionTok{ncol}\NormalTok{(X)],Y,}\DecValTok{2}\NormalTok{)}
\FunctionTok{ls.added.var.plot}\NormalTok{(X[,}\DecValTok{2}\SpecialCharTok{:}\FunctionTok{ncol}\NormalTok{(X)],Y,}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{residual_files/figure-latex/unnamed-chunk-10-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(X[,}\DecValTok{4}\NormalTok{], happy.res.before, }\AttributeTok{xlab=}\StringTok{"Life Expectancy"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"residuals"}\NormalTok{,}\AttributeTok{main=}\StringTok{"Life Expectancy Residual Plot"}\NormalTok{)}
\FunctionTok{ls.part.res.plot}\NormalTok{(X[,}\DecValTok{2}\SpecialCharTok{:}\FunctionTok{ncol}\NormalTok{(X)],Y,}\DecValTok{3}\NormalTok{)}
\FunctionTok{ls.added.var.plot}\NormalTok{(X[,}\DecValTok{2}\SpecialCharTok{:}\FunctionTok{ncol}\NormalTok{(X)],Y,}\DecValTok{3}\NormalTok{)}

\FunctionTok{plot}\NormalTok{(X[,}\DecValTok{5}\NormalTok{], happy.res.before, }\AttributeTok{xlab=}\StringTok{"Freedom"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"residuals"}\NormalTok{, }\AttributeTok{main=}\StringTok{"Freedom Residual Plot"}\NormalTok{)}
\FunctionTok{ls.part.res.plot}\NormalTok{(X[,}\DecValTok{2}\SpecialCharTok{:}\FunctionTok{ncol}\NormalTok{(X)],Y,}\DecValTok{4}\NormalTok{)}
\FunctionTok{ls.added.var.plot}\NormalTok{(X[,}\DecValTok{2}\SpecialCharTok{:}\FunctionTok{ncol}\NormalTok{(X)],Y,}\DecValTok{4}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{residual_files/figure-latex/unnamed-chunk-10-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(X[,}\DecValTok{6}\NormalTok{], happy.res.before, }\AttributeTok{xlab=}\StringTok{"Generosity"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"residuals"}\NormalTok{, }\AttributeTok{main=}\StringTok{"Generosity Residual Plot"}\NormalTok{)}
\FunctionTok{ls.part.res.plot}\NormalTok{(X[,}\DecValTok{2}\SpecialCharTok{:}\FunctionTok{ncol}\NormalTok{(X)],Y,}\DecValTok{5}\NormalTok{)}
\FunctionTok{ls.added.var.plot}\NormalTok{(X[,}\DecValTok{2}\SpecialCharTok{:}\FunctionTok{ncol}\NormalTok{(X)],Y,}\DecValTok{5}\NormalTok{)}

\FunctionTok{plot}\NormalTok{(X[,}\DecValTok{7}\NormalTok{], happy.res.before, }\AttributeTok{xlab=}\StringTok{"Corruption"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"residuals"}\NormalTok{, }\AttributeTok{main=}\StringTok{"Corruption Residual Plot"}\NormalTok{)}
\FunctionTok{ls.part.res.plot}\NormalTok{(X[,}\DecValTok{2}\SpecialCharTok{:}\FunctionTok{ncol}\NormalTok{(X)],Y,}\DecValTok{6}\NormalTok{)}
\FunctionTok{ls.added.var.plot}\NormalTok{(X[,}\DecValTok{2}\SpecialCharTok{:}\FunctionTok{ncol}\NormalTok{(X)],Y,}\DecValTok{6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{residual_files/figure-latex/unnamed-chunk-10-3.pdf}

\end{document}
